{% extends 'base.html' %}
{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SOAP Builder</title>
<style>
  body {
    font-family: Calibri, sans-serif;
    font-size: 11pt;
    margin: 20px;
    background: #f9f9f9;
  }
  label {
    font-weight: bold;
  }
  .section {
    background: white;
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 6px;
    box-shadow: 0 0 8px #ccc;
  }
  .section h2 {
    margin-top: 0;
    margin-bottom: 15px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    font-family: Calibri, sans-serif;
    font-size: 11pt;
  }
  th, td {
    border: 1px solid #666;
    padding: 6px 8px;
    vertical-align: top;
  }
  th {
    background-color: #eee;
    font-weight: bold;
    width: 150px;
    white-space: nowrap;
  }
  .checkbox-group {
    display: flex;
    flex-wrap: wrap;
    gap: 10px 18px;
    align-items: center;
  }
  .checkbox-group label {
    font-weight: normal;
    white-space: nowrap;
  }
  input[type="text"] {
    font-family: Calibri, sans-serif;
    font-size: 11pt;
    padding: 3px 6px;
    width: 180px;
    margin-left: 6px;
  }
  textarea {
    width: 100%;
    height: 120px;
    font-family: Calibri, sans-serif;
    font-size: 11pt;
    padding: 8px;
    box-sizing: border-box;
    resize: vertical;
  }
  .button-row {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    margin-top: 8px;
    gap: 12px;
  }
  .button-row button {
    font-family: Calibri, sans-serif;
    font-size: 11pt;
    padding: 6px 14px;
    cursor: pointer;
  }
  .status-text {
    font-style: italic;
    color: #555;
  }
  .copy-button {
    margin-left: auto;
    background-color: #007bff;
    border: none;
    color: white;
    border-radius: 3px;
  }
  .copy-button:hover {
    background-color: #0056b3;
  }
  /* PT/OT tab styles */
  #therapy-tabs {
    margin-bottom: 20px;
  }
  .therapy-tab {
    font-family: Calibri, sans-serif;
    font-size: 11pt;
    padding: 6px 14px;
    cursor: pointer;
    margin-right: 8px;
    border: 1px solid #ccc;
    background: #eee;
    border-radius: 3px;
    transition: background 0.2s, color 0.2s;
  }
  .therapy-tab.active {
    background: #007bff;
    color: white;
    border-color: #0056b3;
  }
</style>
</head>
<body>

<!-- PT/OT Toggle Tabs -->
<div id="therapy-tabs">
  <button class="therapy-tab active" data-therapy="pt" type="button">PT</button>
  <button class="therapy-tab" data-therapy="ot" type="button">OT</button>
</div>

<!-- Subjective Section -->
<div class="section" id="subjective-section">
  <h2>Subjective</h2>
  <table>
    <tr>
      <th>Patient:</th>
      <td colspan="3" class="checkbox-group">
        <label><input type="checkbox" name="therapist" value="Pt states" /> Pt states</label>
        <label><input type="checkbox" name="therapist" value="Pt reports" /> Pt reports</label>
        <label><input type="checkbox" name="therapist" value="Pt verbalizes" /> Pt verbalizes</label>
        <label><input type="checkbox" name="therapist" value="Pt mentions" /> Pt mentions</label>
        <label><input type="checkbox" name="therapist" value="Pt describes" /> Pt describes</label>
        <label><input type="checkbox" name="therapist" value="Pt expresses" /> Pt expresses</label>
        <label><input type="checkbox" name="therapist" value="Pt complains of" /> Pt complains of</label>
        <label><input type="checkbox" name="therapist" value="Pt requests" /> Pt requests</label>
        <label><input type="checkbox" name="therapist" value="Pt acknowledges" /> Pt acknowledges</label>
        <label><input type="checkbox" name="therapist" value="Pt admits" /> Pt admits</label>
        <label><input type="checkbox" name="therapist" value="Pt notes" /> Pt notes</label>
        <label>Other: <input type="text" name="subjective_patient_other" style="font-family:Calibri; font-size:11pt; width:150px;" /></label>
      </td>
    </tr>
    <tr>
      <th>Sides:</th>
      <td colspan="3" class="checkbox-group">
        <label><input type="checkbox" name="subjective" value="Right" /> Right</label>
        <label><input type="checkbox" name="subjective" value="Left" /> Left</label>
        <label><input type="checkbox" name="subjective" value="Both" /> Both</label>
        <label><input type="checkbox" name="subjective" value="Anterior" /> Anterior</label>
        <label><input type="checkbox" name="subjective" value="Posterior" /> Posterior</label>
        <label><input type="checkbox" name="subjective" value="Medial" /> Medial</label>
        <label><input type="checkbox" name="subjective" value="Lateral" /> Lateral</label>
        <label><input type="checkbox" name="subjective" value="Proximal" /> Proximal</label>
        <label><input type="checkbox" name="subjective" value="Distal" /> Distal</label>
        <label><input type="checkbox" name="subjective" value="Superior" /> Superior</label>
        <label><input type="checkbox" name="subjective" value="Inferior" /> Inferior</label>
        <label><input type="checkbox" name="subjective" value="Central" /> Central</label>
        <label><input type="checkbox" name="subjective" value="Peripheral" /> Peripheral</label>
        <label><input type="checkbox" name="subjective" value="Upper" /> Upper</label>
        <label><input type="checkbox" name="subjective" value="Lower" /> Lower</label>
        <label><input type="checkbox" name="subjective" value="Radial" /> Radial</label>
        <label><input type="checkbox" name="subjective" value="Ulnar" /> Ulnar</label>
        <label><input type="checkbox" name="subjective" value="Dorsal" /> Dorsal</label>
        <label><input type="checkbox" name="subjective" value="Ventral" /> Ventral</label>
        <label>Other: <input type="text" name="subjective_sides_other" style="font-family:Calibri; font-size:11pt; width:150px;" /></label>
      </td>
    </tr>
    <tr>
      <th>Pain:</th>
      <td colspan="3" class="checkbox-group">
        <label><input type="checkbox" name="subjective" value="Yes" /> Yes</label>
        <label><input type="checkbox" name="subjective" value="No" /> No</label>
        <label>Pain Level (0-10): <input type="number" name="pain_scale" min="0" max="10" style="width: 40px;" /></label>
        <label><input type="checkbox" name="subjective" value="Pain at rest" /> At rest</label>
        <label><input type="checkbox" name="subjective" value="Pain with activity" /> With activity</label>
        <label><input type="checkbox" name="subjective" value="Constant" /> Constant</label>
        <label><input type="checkbox" name="subjective" value="Intermittent" /> Intermittent</label>
        <label><input type="checkbox" name="subjective" value="Worse at night" /> Worse at night</label>
        <label>Other: <input type="text" name="subjective_pain_other" style="font-family:Calibri; font-size:11pt; width:150px;" /></label>
      </td>
    </tr>
    <tr>
      <th>Location:</th>
      <td colspan="3" class="checkbox-group">
        <label><input type="checkbox" name="subjective" value="Neck" /> Neck</label>
        <label><input type="checkbox" name="subjective" value="Shoulder" /> Shoulder</label>
        <label><input type="checkbox" name="subjective" value="Arm" /> Arm</label>
        <label><input type="checkbox" name="subjective" value="Elbow" /> Elbow</label>
        <label><input type="checkbox" name="subjective" value="Wrist" /> Wrist</label>
        <label><input type="checkbox" name="subjective" value="Hand" /> Hand</label>
        <label><input type="checkbox" name="subjective" value="Mid Back" /> Mid Back</label>
        <label><input type="checkbox" name="subjective" value="Low Back" /> Low Back</label>
        <label><input type="checkbox" name="subjective" value="Hip" /> Hip</label>
        <label><input type="checkbox" name="subjective" value="Thigh" /> Thigh</label>
        <label><input type="checkbox" name="subjective" value="Leg" /> Leg</label>
        <label><input type="checkbox" name="subjective" value="Knee" /> Knee</label>
        <label><input type="checkbox" name="subjective" value="Calves" /> Calves</label>
        <label><input type="checkbox" name="subjective" value="Ankle" /> Ankle</label>
        <label><input type="checkbox" name="subjective" value="Foot" /> Foot</label>
        <label>Other: <input type="text" name="subjective_location_other" style="font-family:Calibri; font-size:11pt; width:150px;" /></label>
      </td>
    </tr>
    <tr>
      <th>Sensation:</th>
      <td colspan="3" class="checkbox-group">
        <label><input type="checkbox" name="subjective" value="Tension" /> Tension</label>
        <label><input type="checkbox" name="subjective" value="Stiffness" /> Stiffness</label>
        <label><input type="checkbox" name="subjective" value="Weakness" /> Weakness</label>
        <label><input type="checkbox" name="subjective" value="Instability" /> Instability</label>
        <label><input type="checkbox" name="subjective" value="Numbness" /> Numbness</label>
        <label><input type="checkbox" name="subjective" value="Cramping" /> Cramping</label>
        <label><input type="checkbox" name="subjective" value="Spasm" /> Spasm</label>
        <label><input type="checkbox" name="subjective" value="Dull pain" /> Dull pain</label>
        <label><input type="checkbox" name="subjective" value="Sharp Pain" /> Sharp Pain</label>
        <label><input type="checkbox" name="subjective" value="Ache Pain" /> Ache Pain</label>
        <label><input type="checkbox" name="subjective" value="Tingling" /> Tingling</label>
        <label><input type="checkbox" name="subjective" value="Shooting" /> Shooting</label>
        <label><input type="checkbox" name="subjective" value="Throbbing" /> Throbbing</label>
        <label><input type="checkbox" name="subjective" value="pins and needles" /> Pins and Needles</label>
        <label>Other: <input type="text" name="subjective_sensation_other" style="font-family:Calibri; font-size:11pt; width:150px;" /></label>
      </td>
    </tr>
    <tr>
      <th>Feeling:</th>
      <td colspan="3" class="checkbox-group">
        <label><input type="checkbox" name="subjective" value="Improved" /> Improved</label>
        <label><input type="checkbox" name="subjective" value="Satisfied" /> Satisfied</label>
        <label><input type="checkbox" name="subjective" value="Fatigue" /> Fatigue</label>
        <label><input type="checkbox" name="subjective" value="Stable" /> Stable</label>
        <label><input type="checkbox" name="subjective" value="Soreness" /> Soreness</label>
        <label><input type="checkbox" name="subjective" value="Flare-up" /> Flare-Up</label>
        <label><input type="checkbox" name="subjective" value="Indifferent" /> Indfferent</label>
        <label><input type="checkbox" name="subjective" value="No Changes" /> No Changes</label>
        <label><input type="checkbox" name="subjective" value="Concerns" /> Concerns</label>
        <label><input type="checkbox" name="subjective" value="Fine" /> Fine</label>
        <label><input type="checkbox" name="subjective" value="Anxious" /> Anxious</label>
        <label><input type="checkbox" name="subjective" value="Motivated" /> Motivated</label>
        <label><input type="checkbox" name="subjective" value="Hopeful" /> Hopeful</label>
        <label><input type="checkbox" name="subjective" value="Mnmotivated" /> Unmotivated</label>
        <label>Other: <input type="text" name="subjective_feeling_other" style="font-family:Calibri; font-size:11pt; width:150px;" /></label>
      </td>
    </tr>
    <tr>
      <th>Movement Limitations:</th>
      <td colspan="3" class="checkbox-group">
        <label><input type="checkbox" name="subjective" value="Sleeping" /> Sleeping</label>
        <label><input type="checkbox" name="subjective" value="Lying" /> Lying</label>
        <label><input type="checkbox" name="subjective" value="Sitting" /> Sitting</label>
        <label><input type="checkbox" name="subjective" value="Standing" /> Standing</label>
        <label><input type="checkbox" name="subjective" value="Walking" /> Walking</label>
        <label><input type="checkbox" name="subjective" value="Stairs/Steps" /> Stairs/Steps</label>
        <label><input type="checkbox" name="subjective" value="Forward Bending" /> Forward Bending</label>
        <label><input type="checkbox" name="subjective" value="General Movement" /> General Movement</label>
        <label><input type="checkbox" name="subjective" value="Crouching" /> Crouching</label>
        <label><input type="checkbox" name="subjective" value="Holding" /> Holding</label>
        <label><input type="checkbox" name="subjective" value="Gripping" /> Gripping</label>
        <label><input type="checkbox" name="subjective" value="Pulling" /> Pulling</label>
        <label><input type="checkbox" name="subjective" value="Pushing" /> Pushing</label>
        <label><input type="checkbox" name="subjective" value="Carrying" /> Carrying</label>
        <label><input type="checkbox" name="subjective" value="Lifting" /> Lifting</label>
        <label><input type="checkbox" name="subjective" value="Reach Behind" /> Reach Behind</label>
        <label><input type="checkbox" name="subjective" value="Reach Above" /> Reach Above</label>
        <label><input type="checkbox" name="subjective" value="Reach Above" /> Reach Forward</label>
        <label><input type="checkbox" name="subjective" value="Fine Motor Tasks" /> Fine Motor Tasks</label>
        <label><input type="checkbox" name="subjective" value="ADLs" /> ADLs</label>
        <label>Other: <input type="text" name="subjective_Movement_Limitations_other" style="font-family:Calibri; font-size:11pt; width:150px;" /></label>
      </td>
    </tr>
    <tr>
      <th>Activity Limitations:</th>
      <td colspan="3" class="checkbox-group">
        <label><input type="checkbox" name="subjective" value="Cooking" /> Cooking</label>
        <label><input type="checkbox" name="subjective" value="Cleaning" /> Cleaning</label>
        <label><input type="checkbox" name="subjective" value="Grooming" /> Grooming</label>
        <label><input type="checkbox" name="subjective" value="Dressing" /> Dressing</label>
        <label><input type="checkbox" name="subjective" value="Brushing" /> Brushing</label>
        <label><input type="checkbox" name="subjective" value="Bathing/Shower" /> Bathing/Shower</label>
        <label><input type="checkbox" name="subjective" value="Gardening" /> Gardening</label>
        <label><input type="checkbox" name="subjective" value="Laundry" /> Laundry</label>
        <label><input type="checkbox" name="subjective" value="Sweeping" /> Sweeping</label>
        <label><input type="checkbox" name="subjective" value="Driving" /> Driving</label>
        <label><input type="checkbox" name="subjective" value="Gym" /> Gyming</label>
        <label><input type="checkbox" name="subjective" value="Shopping" /> Shopping</label>
        <label><input type="checkbox" name="subjective" value="Recreation" /> Recreation</label>
        <label><input type="checkbox" name="subjective" value="Community Acvities" /> Community Activities</label>
        <label><input type="checkbox" name="subjective" value="Household Management" /> Household Management</label>
        <label>Other: <input type="text" name="subjective_activity_limitations_other" style="font-family:Calibri; font-size:11pt; width:150px;" /></label>
      </td>
    </tr>
    <tr>
      <th>Tolerance:</th>
      <td colspan="3" class="checkbox-group">
        <label><input type="checkbox" name="subjective" value="Symptom Decrease" /> Symptom Decrease</label>
        <label><input type="checkbox" name="subjective" value="Symptom Increase" /> Symptom Increase</label>
        <label><input type="checkbox" name="subjective" value="Improved" /> Improved</label>
        <label><input type="checkbox" name="subjective" value="Progressing" /> Progressing</label>
        <label><input type="checkbox" name="subjective" value="No Changes" /> No Changes</label>
        <label><input type="checkbox" name="subjective" value="Worsened" /> Worsened</label>
        <label><input type="checkbox" name="subjective" value="Declined" /> Declined</label>
        <label><input type="checkbox" name="subjective" value="Symptom-Free" /> Symptom-Free</label>
        <label><input type="checkbox" name="subjective" value="Plateaued" /> Plateaued</label>
        <label><input type="checkbox" name="subjective" value="Good Tolerance" /> Good Tolerance</label>
        <label><input type="checkbox" name="subjective" value="Poor Tolerance" /> Poor Tolerance</label>
        <label><input type="checkbox" name="subjective" value="Fatigued" /> Fatigued</label>
        <label><input type="checkbox" name="subjective" value="Symptom Fluctuation" /> Symptom Fluctuation</label>
        <label><input type="checkbox" name="subjective" value="Minimal Change" /> Minimal Change</label>
        <label><input type="checkbox" name="subjective" value="Soreness After" /> Soreness After</label>
        <label><input type="checkbox" name="subjective" value="Required Rest Breaks" /> Required Rest Breaks</label>
        <label><input type="checkbox" name="subjective" value="Delayed Onset Symptoms" /> Delayed Onset Symptoms</label>
        <label><input type="checkbox" name="subjective" value="Unable to Tolerate" /> Unable to Tolerate</label>
        <label>Other: <input type="text" name="subjective_activity_tolerance_other" style="font-family:Calibri; font-size:11pt; width:150px;" /></label>
      </td>
    </tr>
    <tr>
      <th>Consent:</th>
      <td colspan="3" class="checkbox-group">
        <label><input type="checkbox" name="subjective" value="Pt agrees to tx and POC today." /> Pt agrees to tx and POC today.</label>
        <label><input type="checkbox" name="subjective" value="Pt provided verbal consent." /> Pt provided verbal consent.</label>
        <label><input type="checkbox" name="subjective" value="Pt/family provided consent." /> Pt/family provided consent.</label>
        <label>Other: <input type="text" name="subjective_activity_consent_other" style="font-family:Calibri; font-size:11pt; width:150px;" /></label>
      </td>
    </tr>
  </table>
  <div class="button-row">
    <button id="generate-subjective-btn">AI Generate Subjective</button>
    <span id="subjective-status" class="status-text"></span>
    <button class="copy-button" data-target="subjective-text">Copy</button>
  </div>
  <textarea id="subjective-text" placeholder="Subjective Field: Final Text"></textarea>
</div>

<!-- Assessment Section -->
<div class="section" id="assessment-section">
  <h2>Assessment</h2>
  <table>
    <tr>
      <th>Area of Interest:</th>
      <td class="checkbox-group">
        <label><input type="checkbox" name="assessment" value="C-spine" /> C-spine</label>
        <label><input type="checkbox" name="assessment" value="T-spine" /> T-spine</label>
        <label><input type="checkbox" name="assessment" value="L-spine" /> L-spine</label>
        <label><input type="checkbox" name="assessment" value="Shoulder" /> Shoulder</label>
        <label><input type="checkbox" name="assessment" value="Ribs" /> Ribs</label>
        <label><input type="checkbox" name="assessment" value="Scapula" /> Scapula</label>
        <label><input type="checkbox" name="assessment" value="Hip" /> Hip</label>
        <label><input type="checkbox" name="assessment" value="Knee" /> Knee</label>
        <label><input type="checkbox" name="assessment" value="Ankle" /> Ankle</label>
        <label><input type="checkbox" name="assessment" value="Foot" /> Foot</label>
        <label><input type="checkbox" name="assessment" value="Arm" /> Arm</label>
        <label><input type="checkbox" name="assessment" value="Forearm" /> Forearm</label>
        <label><input type="checkbox" name="assessment" value="Elbow" /> Elbow</label>
        <label><input type="checkbox" name="assessment" value="Wrist" /> Wrist</label>
        <label><input type="checkbox" name="assessment" value="Hand" /> Hand</label>
        <label><input type="checkbox" name="assessment" value="Leg" /> Leg</label>
        <label>
          <input type="checkbox" name="assessment" value="Paraspinals, Qudratus Lumborum, Gluteus Medius, Piriformis,TFL" />
          Paraspinals, QL, Gluteus Medius, Piriformis, TFL
        </label>
        <label>
          <input type="checkbox" name="assessment" value="Quadriceps_TFL_Sartorius_IT_Band" />
          Quadriceps, TFL, Sartorius, IT Band
        </label>
        <label>
          <input type="checkbox" name="assessment" value="Hamstring, Gastrocnemius, Soleus, Posterior Tibialis" />
          Hamstring, Gastrocnemius, Soleus, Posterior Tibialis
        </label>
        <label>
          <input type="checkbox" name="assessment" value="Tibialis Anterior, Fibularis" />
          Tibialis Anterior, Fibularis
        </label>
        <label><input type="checkbox" name="assessment" value="Deltoid" /> Deltoid</label>
        <label><input type="checkbox" name="assessment" value="Rotator Cuff" /> Rotator Cuff</label>
        <label><input type="checkbox" name="assessment" value="Trapezius" /> Trapezius</label>
        <label><input type="checkbox" name="assessment" value="Levator Scapulae" /> Levator Scapulae</label>
        <label><input type="checkbox" name="assessment" value="Rhomboids" /> Rhomboids</label>
        <label><input type="checkbox" name="assessment" value="Pectoralis Major" /> Pectoralis Major</label>
        <label><input type="checkbox" name="assessment" value="Biceps Brachii" /> Biceps Brachii</label>
        <label><input type="checkbox" name="assessment" value="Triceps Brachii" /> Triceps Brachii</label>
        <label><input type="checkbox" name="assessment" value="Latissimus Dorsi" /> Latissimus Dorsi</label>
        <label><input type="checkbox" name="assessment" value="Core" /> Core</label>
        <label><input type="checkbox" name="assessment" value="Hamstring" /> Hamstring</label>
        <label><input type="checkbox" name="assessment" value="TFL" /> TFL</label>
        <label><input type="checkbox" name="assessment" value="IT band" /> IT band</label>
        <label><input type="checkbox" name="assessment" value="Tibialis/Fibularis" /> Tibialis/Fibularis</label>
        <label><input type="checkbox" name="assessment" value="Gastroc/Soleus" /> Gastroc/Soleus</label>
        <label>Other: <input type="text" name="assessment_other" style="width:150px; font-size:11pt; font-family:Calibri;" /></label>
      </td>
    </tr>
    <tr>
      <th>Assessment:</th>
      <td class="checkbox-group">
        <label><input type="checkbox" name="assessment" value="Tender To Palpation" /> Tender To Palpation</label>
        <label><input type="checkbox" name="assessment" value="Soft Tissue Adhesion/Restriction" /> Soft Tissue Adhesion/Restriction</label>
        <label><input type="checkbox" name="assessment" value="Myotension" /> Myotension</label>
        <label><input type="checkbox" name="assessment" value="Joint Hypomobility" /> Joint Hypomobility</label>
        <label><input type="checkbox" name="assessment" value="Joint Hypermobility" /> Joint Hypermobility</label>
        <label><input type="checkbox" name="assessment" value="Movement Restriction" /> Movement Restriction</label>
        <label><input type="checkbox" name="assessment" value="Compensated Movement" /> Compensated Movement</label>
        
        <label><input type="checkbox" name="assessment" value="Antalgic Movement" /> Antalgic Movement</label>
        <label><input type="checkbox" name="assessment" value="Poor Balance" /> Poor Balance</label>
        <label><input type="checkbox" name="assessment" value="Decreased Coordination" /> Decreased Coordination</label>
        <label><input type="checkbox" name="assessment" value="Difficulty w/ Dual Tasking" /> Difficulty w/ Dual Tasking</label>
        <label><input type="checkbox" name="assessment" value="Pain with Palpation" /> Pain with Palpation</label>
        <label><input type="checkbox" name="assessment" value="Pain with Movement" /> Pain with Movement</label>
        <label><input type="checkbox" name="assessment" value="Pain at End Range" /> Pain at End Range</label>
        <label><input type="checkbox" name="assessment" value="Crepitus" /> Crepitus</label>
        <label><input type="checkbox" name="assessment" value="Instability" /> Instability</label>
        <label><input type="checkbox" name="assessment" value="Laxity" /> Laxity</label>
        <label><input type="checkbox" name="assessment" value="Forward Lean" /> Forward Lean</label>
        <label><input type="checkbox" name="assessment" value="Slouch Posture" /> Slouch Posture</label>
        <label><input type="checkbox" name="assessment" value="Guard Movement" /> Guard Movement</label>
        <label><input type="checkbox" name="assessment" value="Fear of Falling" /> Fear of Falling</label>
        <label><input type="checkbox" name="assessment" value="Apprehension w/ Movement" /> Apprehension w/ Movement</label>
        <label><input type="checkbox" name="assessment" value="Decrease Step Length" /> Decrease Step Length</label>
        <label><input type="checkbox" name="assessment" value="Trendelenburg Gait" /> Trendelenburg Gait</label>
        <label><input type="checkbox" name="assessment" value="Parkinson’s Gait" /> Parkinson’s Gait</label>
        <label><input type="checkbox" name="assessment" value="Hemiplegia Gait" /> Hemiplegia Gait</label>
        <label>Other: <input type="text" name="assessment_other_text" style="width:150px; font-size:11pt; font-family:Calibri;" /></label>
      </td>
    </tr>
    <tr>
      <th>Tx Intervention:</th>
      <td class="checkbox-group">
        <label><input type="checkbox" name="assessment" value="Manual Therapy" /> Manual Therapy</label>
        <label><input type="checkbox" name="assessment" value="Stretch" /> Stretch</label>
        <label><input type="checkbox" name="assessment" value="Trigger Point Release" /> Trigger Point Release</label>
        <label><input type="checkbox" name="assessment" value="MFR" /> Myofascia Release</label>
        <label><input type="checkbox" name="assessment" value="Joint Mobilization" /> Joint Mobilization</label>
        <label><input type="checkbox" name="assessment" value="HVLA" /> HVLA</label>
        <label><input type="checkbox" name="assessment" value="Movement With Mobility" /> Movement With Mobility</label>
        <label><input type="checkbox" name="assessment" value="Ther Ex" /> Ther Ex</label>
        <label><input type="checkbox" name="assessment" value="Ther Act" /> Ther Act</label>
        <label><input type="checkbox" name="assessment" value="Balance Training" /> Balance Training</label>
        <label><input type="checkbox" name="assessment" value="Proprioceptive Training" /> Proprioceptive Training</label>
        <label><input type="checkbox" name="assessment" value="Core Stabilization" /> Core Stabilization</label>
        <label><input type="checkbox" name="assessment" value="Postural Training" /> Postural Training</label>
        <label><input type="checkbox" name="assessment" value="Functional Training" /> Functional Training</label>
        <label><input type="checkbox" name="assessment" value="Task-specific Training" /> Task-specific Training</label>
        <label><input type="checkbox" name="assessment" value="Vestibular Rehab" /> Vestibular Rehab</label>
        <label><input type="checkbox" name="assessment" value="PNF Patterns" /> PNF Patterns</label>
        <label><input type="checkbox" name="assessment" value="IASTM" /> IASTM</label>
        <label><input type="checkbox" name="assessment" value="Gait Training" /> Gait Training</label>
        <label><input type="checkbox" name="assessment" value="Neuromuscular Re-education" /> Neuromuscular Re-education</label>
        <label><input type="checkbox" name="assessment" value="Contract Relax" /> Contract Relax</label>
        <label><input type="checkbox" name="assessment" value="Hold Relax" /> Hold Relax</label>
        <label><input type="checkbox" name="assessment" value="Ice x 10 min" /> Ice x 10 min</label>
        <label><input type="checkbox" name="assessment" value="Heat x 10 min" /> Heat x 10 min</label>
        <label><input type="checkbox" name="assessment" value="LLPS x 10 min" /> LLPS x 10 min</label>
        <label>Other: <input type="text" name="assessment_intervention_other" style="width:150px; font-size:11pt; font-family:Calibri;" /></label>
      </td>
    </tr>
    <tr>
      <th>Tx Tolerance:</th>
      <td class="checkbox-group">
        <label><input type="checkbox" name="assessment" value="Good" /> Good</label>
        <label><input type="checkbox" name="assessment" value="Good-" /> Good-</label>
        <label><input type="checkbox" name="assessment" value="Fair+" /> Fair+</label>
        <label><input type="checkbox" name="assessment" value="Fair" /> Fair</label>
        <label><input type="checkbox" name="assessment" value="Fair-" /> Fair-</label>
        <label><input type="checkbox" name="assessment" value="Poor+" /> Poor+</label>
        <label><input type="checkbox" name="assessment" value="Poor" /> Poor</label>
        <label><input type="checkbox" name="assessment" value="Improve" /> Improve</label>
        <label><input type="checkbox" name="assessment" value="Progressing" /> Progressing</label>
        <label><input type="checkbox" name="assessment" value="Regressing" /> Regressing</label>
        <label><input type="checkbox" name="assessment" value="No Changes" /> No Changes</label>
        <label>Other: <input type="text" name="assessment_tolerance_other" style="width:150px; font-size:11pt; font-family:Calibri;" /></label>
      </td>
    </tr>
    <tr>
      <th>Functional Activity Training:</th>
      <td class="checkbox-group">
        <label><input type="checkbox" name="assessment" value="Verbal Cue" /> Verbal Cue</label>
        <label><input type="checkbox" name="assessment" value="Tactile Cue" /> Tactile Cue</label>
        <label><input type="checkbox" name="assessment" value="Demonstration" /> Demonstration</label>
        <label><input type="checkbox" name="assessment" value="Education" /> Education</label>
        <label><input type="checkbox" name="assessment" value="Illustration" /> Illustration</label>
        <label><input type="checkbox" name="assessment" value="Therapist Guidance" /> Therapist Guidance</label>
        <label><input type="checkbox" name="assessment" value="Tap Facilitation" /> Tap Facilitation</label>
        <label>Other: <input type="text" name="assessment_functional_other" style="width:150px; font-size:11pt; font-family:Calibri;" /></label>
      </td>
    </tr>
    <tr>
      <th>Outcome:</th>
      <td class="checkbox-group">
        <label><input type="checkbox" name="assessment" value="Decrease Tension" /> Decrease Tension</label>
        <label><input type="checkbox" name="assessment" value="Symptoms Reduction" /> Symptoms Reduction</label>
        <label><input type="checkbox" name="assessment" value="Pain Reduction" /> Pain Reduction</label>
        <label><input type="checkbox" name="assessment" value="Improved Tissue Mobility" /> Improved Tissue Mobility</label>
        <label><input type="checkbox" name="assessment" value="Acknowledged Education/Instruction" /> Acknowledged Education/Instruction</label>
        <label><input type="checkbox" name="assessment" value="Demonstrated Understanding" /> Demonstrated Understanding</label>
        <label><input type="checkbox" name="assessment" value="Improved Movement Tolerance" /> Improved Movement Tolerance</label>
        <label><input type="checkbox" name="assessment" value="Improved Safety Awareness" /> Improved Safety Awareness</label>
        <label><input type="checkbox" name="assessment" value="Adhered to HEP" /> Adhered to HEP</label>
        <label><input type="checkbox" name="assessment" value="Benefit from Adherence to POC" /> Benefit from Adherence to POC</label>
        <label><input type="checkbox" name="assessment" value="Improved Strength" /> Improved Strength</label>
        <label><input type="checkbox" name="assessment" value="Improved ROM" /> Improved ROM</label>
        <label><input type="checkbox" name="assessment" value="Improved Endurance" /> Improved Endurance</label>
        <label><input type="checkbox" name="assessment" value="Improved Functional Mobility" /> Improved Functional Mobility</label>
        <label><input type="checkbox" name="assessment" value="Improved Balance" /> Improved Balance</label>
        <label><input type="checkbox" name="assessment" value="Improved Coordination" /> Improved Coordination</label>
        <label><input type="checkbox" name="assessment" value="Improved Posture" /> Improved Posture</label>
        <label><input type="checkbox" name="assessment" value="Decreased Swelling/Edema" /> Decreased Swelling/Edema</label>
        <label><input type="checkbox" name="assessment" value="Increased Independence" /> Increased Independence</label>
        <label><input type="checkbox" name="assessment" value="Improved Gait" /> Improved Gait</label>
        <label><input type="checkbox" name="assessment" value="Improved Transfers" /> Improved Transfers</label>
        <label><input type="checkbox" name="assessment" value="Improved ADL Participation" /> Improved ADL Participation</label>
        <label><input type="checkbox" name="assessment" value="Achieved Short-term Goals" /> Achieved Short-term Goals</label>
        <label><input type="checkbox" name="assessment" value="Achieved Long-term Goals" /> Achieved Long-term Goals</label>
        <label><input type="checkbox" name="assessment" value="Patient Demonstrated Correct Technique" /> Patient Demonstrated Correct Technique</label>
        <label><input type="checkbox" name="assessment" value="No Significant Change" /> No Significant Change</label>
        <label><input type="checkbox" name="assessment" value="Regression in Function" /> Regression in Function</label>
        <label><input type="checkbox" name="assessment" value="Requires Continued Skilled Therapy" /> Requires Continued Skilled Therapy</label>
        <label><input type="checkbox" name="assessment" value="Patient Able to Verbalize POC" /> Patient Able to Verbalize POC</label>
        <label>Other: <input type="text" name="assessment_outcome_other" style="width:150px; font-size:11pt; font-family:Calibri;" /></label>
      </td>
    </tr>
    <tr>
      <th>Summary Length:</th>
      <td class="checkbox-group">
        <label><input type="checkbox" name="assessment_summary_length" value="4 Sentences Summary" /> 4 Sentences Summary</label>
        <label><input type="checkbox" name="assessment_summary_length" value="5 Sentences Summary" /> 5 Sentences Summary</label>
        <label><input type="checkbox" name="assessment_summary_length" value="6 Sentences Summary" /> 6 Sentences Summary</label>
        <label><input type="checkbox" name="assessment_summary_length" value="7 Sentences Summary" /> 7 Sentences Summary</label>
        <label>
          <input type="checkbox" id="assessment_summary_other_cb" name="assessment_summary_length" value="Other" />
          Other:
          <input type="text" id="assessment_summary_other_text" name="assessment_summary_other" style="width:150px; font-size:11pt; font-family:Calibri; display:none; margin-left:6px;" placeholder="Enter custom summary length" />
        </label>
      </td>
    </tr>
  </table>
  <div class="button-row">
    <button id="generate-assessment-btn">AI Generate Assessment</button>
    <span id="assessment-status" class="status-text"></span>
    <button class="copy-button" data-target="assessment-text">Copy</button>
  </div>
  <textarea id="assessment-text" placeholder="Assessment Field: Final Text"></textarea>
</div>

<!-- Plan of Care Section -->
<div class="section" id="plan-section">
  <h2>Plan of Care</h2>
  <table>
    <tr>
      <th>Next Visit Plan:</th>
      <td class="checkbox-group">
        <label><input type="checkbox" name="plan" value="Manual Therapy" /> Manual Therapy</label>
        <label><input type="checkbox" name="plan" value="MFR" /> MFR</label>
        <label><input type="checkbox" name="plan" value="STM" /> STM</label>
        <label><input type="checkbox" name="plan" value="TPR" /> TPR</label>
        <label><input type="checkbox" name="plan" value="Stretch" /> Stretch</label>
        <label><input type="checkbox" name="plan" value="Joint Mobilization" /> Joint Mobilization</label>
        <label><input type="checkbox" name="plan" value="Therapeutic Exercise Training" /> Therapeutic Exercise Training</label>
        <label><input type="checkbox" name="plan" value="Therapeutic Activity Training" /> Therapeutic Activity Training</label>
        <label><input type="checkbox" name="plan" value="Balance Training" /> Balance Training</label>
        <label><input type="checkbox" name="plan" value="Pain Management" /> Pain Management</label>
        <label><input type="checkbox" name="plan" value="Gait Training" /> Gait Training</label>
        <label><input type="checkbox" name="plan" value="Neuromuscular Training" /> Neuromuscular Training</label>
        <label><input type="checkbox" name="plan" value="Core Stabilization Training" /> Core Stabilization Training</label>
        <label><input type="checkbox" name="plan" value="Postural Training" /> Postural Training</label>
        <label><input type="checkbox" name="plan" value="Body Mechanics Training" /> Body Mechanics Training</label>
        <label><input type="checkbox" name="plan" value="Functional Training" /> Functional Training</label>
        <label><input type="checkbox" name="plan" value="Task-Specific Training" /> Task-Specific Training</label>
        <label><input type="checkbox" name="plan" value="Vestibular Rehab" /> Vestibular Rehab</label>
        <label><input type="checkbox" name="plan" value="PNF Training" /> PNF Training</label>
        <label><input type="checkbox" name="plan" value="IASTM" /> IASTM</label>
        <label><input type="checkbox" name="plan" value="Ice" /> Ice</label>
        <label><input type="checkbox" name="plan" value="Heat" /> Heat</label>
        <label><input type="checkbox" name="plan" value="E-Stim" /> E-Stim</label>
        <label><input type="checkbox" name="plan" value="LLPS" /> LLPS</label>
        <label><input type="checkbox" name="plan" value="Education" /> Education</label>
        <label><input type="checkbox" name="plan" value="HEP Review" /> HEP Review</label>
        <label><input type="checkbox" name="plan" value="Fall/Safety Training" /> Fall/Safety Training</label>
        <label><input type="checkbox" name="plan" value="Energy Conservation Training" /> Energy Conservation Training</label>
        <label><input type="checkbox" name="plan" value="Patient/Family Goals Review" /> Patient/Family Goals Review</label>
        <label><input type="checkbox" name="plan" value="Task/Dual Task Training" /> Task/Dual Task Training</label>
        <label>Other: <input type="text" name="plan_other" style="width:150px; font-size:11pt; font-family:Calibri;" /></label>
      </td>
    </tr>
    <tr>
      <th>Summary Length:</th>
      <td class="checkbox-group">
        <label><input type="checkbox" name="plan_summary_length" value="1 Sentence Summary" /> 1 Sentence Summary</label>
        <label><input type="checkbox" name="plan_summary_length" value="2 Sentences Summary" /> 2 Sentences Summary</label>
        <label><input type="checkbox" name="plan_summary_length" value="3 Sentences Summary" /> 3 Sentences Summary</label>
        <label><input type="checkbox" name="plan_summary_length" value="4 Sentences Summary" /> 4 Sentences Summary</label>
      </td>
    </tr>
  </table>
  <div class="button-row">
    <button id="generate-plan-btn">AI Generate Plan</button>
    <span id="plan-status" class="status-text"></span>
    <button class="copy-button" data-target="plan-text">Copy</button>
  </div>
  <textarea id="plan-text" placeholder="Plan Field: Final Text"></textarea>
</div>

<script>
// --- PT/OT tab selection ---
 let selectedTherapy = 'pt'; // default PT

 document.querySelectorAll('.therapy-tab').forEach(btn => {
   btn.addEventListener('click', () => {
     document.querySelectorAll('.therapy-tab').forEach(b => b.classList.remove('active'));
     btn.classList.add('active');
     selectedTherapy = btn.dataset.therapy;
   });
 });

 // Copy button functionality
 function copyToClipboard(textareaId) {
   const textarea = document.getElementById(textareaId);
   textarea.select();
   textarea.setSelectionRange(0, 99999);
   document.execCommand('copy');
   alert('Copied to clipboard');
 }
 document.querySelectorAll('.copy-button').forEach(btn => {
   btn.addEventListener('click', () => {
     copyToClipboard(btn.getAttribute('data-target'));
   });
 });

 // Helper to get checked values by name
 function getCheckedValues(name) {
   return Array.from(document.querySelectorAll(`input[name="${name}"]:checked`)).map(cb => cb.value);
 }

 // Helper to get trimmed text input value if present
 function getTextInputValue(name) {
   const el = document.querySelector(`input[name="${name}"]`);
   return el && el.value.trim() !== '' ? el.value.trim() : null;
 }

 // Generate Subjective
 document.getElementById('generate-subjective-btn').addEventListener('click', async () => {
   const status = document.getElementById('subjective-status');
   let values = getCheckedValues('therapist').concat(getCheckedValues('subjective'));

   const sensationOther = getTextInputValue('subjective_sensation_other');
   const feelingOther = getTextInputValue('subjective_feeling_other');
   const activityOther = getTextInputValue('subjective_activity_other');

   if (sensationOther) values.push(`Sensation Other: ${sensationOther}`);
   if (feelingOther) values.push(`Feeling Other: ${feelingOther}`);
   if (activityOther) values.push(`Activity Limitations Other: ${activityOther}`);

   if (values.length === 0) {
     alert('Please select some subjective checkboxes or enter other information first.');
     return;
   }
   status.textContent = 'Generating...';
   try {
     const prompt = `Rewrite this patient's subjective information into a clear professional narrative suitable for clinical notes:\n\n${values.join(' ')}`;
     const endpoint = selectedTherapy === 'ot' ? '/api/generate-subjective-ot' : '/api/generate-subjective';
     const response = await fetch(endpoint, {
       method: 'POST',
       headers: {'Content-Type': 'application/json'},
       body: JSON.stringify({prompt}),
     });
     const data = await response.json();
     if (data.text) {
       document.getElementById('subjective-text').value = data.text;
       status.textContent = 'Done.';
     } else {
       status.textContent = '';
       alert('Error generating subjective text.');
     }
   } catch {
     status.textContent = '';
     alert('Error generating subjective text.');
   }
 });

 // Generate Assessment
 document.getElementById('generate-assessment-btn').addEventListener('click', async () => {
   const status = document.getElementById('assessment-status');
   let values = getCheckedValues('assessment');

   const summaryLengths = getCheckedValues('assessment_summary_length');
   if (summaryLengths.length > 0) {
     values.push(`Summary Length: ${summaryLengths.join(' ')}`);
   }

   if (values.length === 0) {
     alert('Please select some assessment checkboxes or enter other information first.');
     return;
   }
   status.textContent = 'Generating...';
   try {
     const prompt = `Rewrite this assessment into a professional clinical note narrative:\n\n${values.join(' ')}`;
     const endpoint = selectedTherapy === 'ot' ? '/api/generate-assessment-ot' : '/api/generate-assessment';
     const response = await fetch(endpoint, {
       method: 'POST',
       headers: {'Content-Type': 'application/json'},
       body: JSON.stringify({prompt}),
     });
     const data = await response.json();
     if (data.text) {
       let resultText = data.text.trim();
       // Remove "Assessment:" from the start if present (case insensitive)
       if (resultText.toLowerCase().startsWith('assessment:')) {
         resultText = resultText.substring('assessment:'.length).trim();
       }
       document.getElementById('assessment-text').value = resultText;
       status.textContent = 'Done.';
     } else {
       status.textContent = '';
       alert('Error generating assessment text.');
     }
   } catch {
     status.textContent = '';
     alert('Error generating assessment text.');
   }
 });

 // Generate Plan
 document.getElementById('generate-plan-btn').addEventListener('click', async () => {
   const status = document.getElementById('plan-status');
   let values = getCheckedValues('plan');

   const summaryLengths = getCheckedValues('plan_summary_length');
   if (summaryLengths.length > 0) {
     values.push(`Summary Length: ${summaryLengths.join(' ')}`);
   }

   const planOtherText = getTextInputValue('plan_other');
   if (planOtherText) values.push(`Other Plan: ${planOtherText}`);

   if (values.length === 0) {
     alert('Please select some plan checkboxes or enter other information first.');
     return;
   }
   status.textContent = 'Generating...';
   try {
     const prompt = `Rewrite this plan of care into a clear professional narrative suitable for clinical notes:\n\n${values.join(' ')}`;
     const endpoint = selectedTherapy === 'ot' ? '/api/generate-plan-ot' : '/api/generate-plan';
     const response = await fetch(endpoint, {
       method: 'POST',
       headers: {'Content-Type': 'application/json'},
       body: JSON.stringify({prompt}),
     });
     const data = await response.json();
     if (data.text) {
       document.getElementById('plan-text').value = data.text;
       status.textContent = 'Done.';
     } else {
       status.textContent = '';
       alert('Error generating plan text.');
     }
   } catch {
     status.textContent = '';
     alert('Error generating plan text.');
   }
 });
</script>

</body>
</html>
{% endblock %}
